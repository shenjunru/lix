/*
 * LiX JavaScript CSS selector engine
 * Project since: 2009-02-18
 * Version: 1.0.3.3 build 20090629
 * 
 * Copyright (c) 2009 Shen Junru
 * Released under the MIT, BSD, and GPL Licenses.
 * 
 * Inspiration:
 * 	- Some functionality inspired by [sizzle.js](http://sizzlejs.com)
*/
(function(){var t=function(){this.prev=null;this.next=null;this.group=0;this.tag="*";this.id="";this.filter="";this.detector={}},k={CHAR:/^\s*([>~+#\*\w\u00c0-\uFFFF_\-.:\[,])/,SPLIT:/^\s*,\s*/,TAG:/^\s*(\*|[\w\u00c0-\uFFFF_-]+)/,ID:/^(\s*)#(\*|[\w\u00c0-\uFFFF_-]+)/,FILTER:/^\s*([>~+])\s*(\*|[\w\u00c0-\uFFFF_-]+)/,CLASS:/^(\s*)\.([\w\d\u00C0-\uFFFF_-]+)/,PSEUDO:/^\s*:(\w[\w\-]*)(?:\(([^\)]+)\))?/,ATTR:/^\s*\[\s*([\w\d]+)\s*(?:([!~$|*^]?=)\s*([\w\d\-\.\u00C0-\uFFFF]+|"([^"]*)"|'([^']*)')\s*)?\]/,NTH:/(-?)(\d*)n((?:\+|-)?\d*)/},q={},p=function(x){return new SyntaxError("css parse error, char:"+x)},c={".":function(x,y,z){x.detector["."]=x.detector["."]||[];x.detector["."].push(y[2])},":":function(x,z,A){try{x.detector[":"]=x.detector[":"]||[];var y=z[1],B=z[2],D=g[":"][y];if(B&&D){B=D(B)}x.detector[":"].push({name:y,value:B})}catch(C){if(C!=q){throw p(A)}}},"[]":function(x,z,A){try{x.detector["[]"]=x.detector["[]"]||[];var y=z[1],D=z[2]||"",B=z[5]||z[4]||z[3],E=g["[]"][y];if(B&&E){B=E(D,B)}x.detector["[]"].push({name:y,expr:D,value:B,target:null})}catch(C){if(C!=q){throw p(A)}}}},g={":":{not:function(C){var A={detector:{}},B=0,x=C.length,D,z,y;while(B<x){D=C.slice(B,x),z=k.CHAR.exec(D);if(!z){break}switch(z[1]){case".":y=k.CLASS.exec(D);if(y){c["."](A,y)}break;case":":y=k.PSEUDO.exec(D);if(y){c[":"](A,y)}break;case"[":y=k.ATTR.exec(D);if(y){c["[]"](A,y)}break}B+=(y?y[0]:D).length}return A},"nth-child":function(y){if(/^\bn\b$/i.test(y)){throw q}var x=k.NTH.exec(y=="even"&&"2n"||y=="odd"&&"2n+1"||!/\D/.test(y)&&"0n+"+y||y);return{a:(x[1]+(x[2]||1))-0,b:x[3]-0}}},"[]":{"class":function(y,x){if(!x){return x}switch(y){case"*=":return x;case"|=":case"^=":return" "+x;case"$=":return x+" ";default:return" "+x+" "}}}},r=function(D){var C=[],A=0,z=D.length,B=0,x=true,F,H,E,y,G;while(A<z){F=D.slice(A,z),H=k.CHAR.exec(F);if(!H){throw p(A)}y=new t(),y.group=B;switch(H[1]){case">":case"~":case"+":E=k.FILTER.exec(F);if(E){y.filter=E[1],y.tag=E[2];if(G){G.next=y,y.prev=G}}break;case"#":E=k.ID.exec(F);if(E){if(!E[1]){y=G||y}y.filter="#",y.id=E[2];if(E[1]&&G){G.next=y,y.prev=G}}break;case".":E=k.CLASS.exec(F);if(E){if(E[1]&&G){G.next=y,y.prev=G}else{y=G||y}c["."](y,E,A)}break;case":":E=k.PSEUDO.exec(F);if(E){y=G||y,c[":"](y,E,A)}break;case"[":E=k.ATTR.exec(F);if(E){y=G||y,c["[]"](y,E,A)}break;case",":E=k.SPLIT.exec(F);if(E){x=true,B++,G=y=null}break;default:E=k.TAG.exec(F);if(E){y.tag=E[1];if(G){G.next=y,y.prev=G}}break}if(!E){throw p(A)}A+=E[0].length;if(x&&(G||y)){C.push(G||y),x=false}G=y}return C};if(!document.nodeType){document.nodeType=9}var w=window.LiX=function(y,B){B=[B||document];var z=[];if(typeof(y)==="string"&&v(B[0])){try{var x=r(y),A=0,D;while(D=x[A++]){e(z,D,B)}}catch(C){throw C}}return z},m={},e=function(E,z,y){var B=z.next;if(B){var D=[],A=0;z.next=null;arguments.callee(D,z,y);D.lenght==0||arguments.callee(E,B,D);z.next=B}else{if(!y.length){y=document}var A=0,F,x=n(z,y);m={};try{while(F=x[A++]){if(F.nodeType){l[z.filter](E,z,F)}}}catch(C){if(C!=q){throw C}}}},o=function(x,y){return x.tag=="*"?true:y.tagName.toLowerCase()==x.tag.toLowerCase()},s=function(x,A,z){var B,y=true;for(B in x.detector){if(!y){break}y=i[B](A,x.detector[B],z)}return y},h={"class":"className","for":"htmlFor",id:"id"},b=function(x){return x.nodeType===9&&x.documentElement.nodeName!=="HTML"||!!x.ownerDocument&&x.ownerDocument.documentElement.nodeName!=="HTML"},v=function(x){return(x&&(x.nodeType===1||x.nodeType===9))},j=(function(){if(document.documentElement.compareDocumentPosition){return function(x,y){return(x.compareDocumentPosition(y)&16)===16}}if(document.documentElement.contains){return function(x,y){return x.contains(y)&&x!==y}}return function(x,y){while(y=y.parentNode){if(y==x){return true}}return false}})(),a=function(z){var y=0,x=z.parentNode.firstChild;if(m.node&&m.node.parentNode===z.parentNode){y=m.index,x=m.node}for(;x;x=x.nextSibling){if(x===z){m.node=z,m.index=y;return ++y}else{if(x.nodeType===1){++y}}}},n=function(x,B){var C,y,A=0,z=[];switch(x.filter){case"~":while(C=B[A++]){if(C.nodeType){z.push(C);break}}while(y=C,C=B[A++]){if(j(y,C)){z.push(C)}}return z;case"":while(C=B[A++]){if(C.nodeType){z.push(C);break}}while(y=C,C=B[A++]){if(j(C,y)){z=[C]}else{if(!j(y,C)){z.push(C)}}}return z;default:return B}},d=function(y,x){if(x in h){return y[h[x]]}return y.getAttribute(x)},u=function(x,y){var z=d(y,x.name);switch(x.name){case"class":x.target=z?" "+z+" ":null;break;default:x.target=z}return x},l={"":function(z,x,B){var A=0,C,y=B.getElementsByTagName(x.tag)||[];while(C=y[A++]){if(s(x,C,null)){z.push(C)}}},"#":function(y,x,z){var A=(z.ownerDocument||document).getElementById(x.id);if(A&&A.getAttributeNode("id")&&o(x,A)&&s(x,A,null)){if(x.prev==null){y.push(A)}else{if(j(z,A)){y.push(A)}}throw q}},">":function(z,x,C){var B=0,y=1,D,A=C.childNodes||[];while(D=A[B++]){if(D.nodeType==1&&o(x,D)&&s(x,D,y++)){z.push(D)}}},"+":function(y,x,z){var A=z;while(A=A.nextSibling){if(A.nodeType==1){if(o(x,A)&&s(x,A,null)){y.push(A)}break}}},"~":function(y,x,z){var A=z;while(A=A.nextSibling){if(A.nodeType==1&&o(x,A)&&s(x,A,null)){y.push(A)}}}},i={":":function(B,C,z){var y=true,A=0,D;while(y&&(D=C[A++])){var x=f.PSEUDO[D.name.toLowerCase()];y=x?x(B,D.value,z):false}return y},".":function(B,C,y){if(!B.className){return false}var x=true,A=0,D,z=" "+B.className+" ";while(x&&(D=C[A++])){x=z.indexOf(D)>-1}return x},"[]":function(B,C,z){var y=true,A=0,x;while(y&&(x=C[A++])){x=u(x,B);y=f.ATTR[x.expr](x.target,x.value)}return y}},f={ATTR:{"":function(y,x){return !!y},"=":function(y,x){return y==x},"!=":function(y,x){return y!=x},"~=":function(y,x){return y?(" "+y+" ").indexOf(x)>=0:false},"^=":function(y,x){return y?y.indexOf(x)===0:false},"$=":function(y,x){return y?y.substr(y.length-x.length)===x:false},"*=":function(y,x){return y?y.indexOf(x)>=0:false},"|=":function(y,x){return y?y===x||y.substr(0,x.length+1)===x+"-":false}},PSEUDO:{button:function(x){return"button"===x.type||x.nodeName.toUpperCase()==="BUTTON"},checkbox:function(x){return"checkbox"===x.type},file:function(x){return"file"===x.type},image:function(x){return"image"===x.type},input:function(x){return/input|select|textarea|button/i.test(x.nodeName)},password:function(x){return"password"===x.type},radio:function(x){return"radio"===x.type},reset:function(x){return"reset"===x.type},submit:function(x){return"submit"===x.type},text:function(x){return"text"===x.type},enabled:function(x){return x.disabled===false&&x.type!=="hidden"},disabled:function(x){return true},checked:function(x){return x.checked===true},selected:function(x){return x.selected===true},hidden:function(x){return x.offsetWidth===0||x.offsetHeight===0},visible:function(x){return x.offsetWidth>0||x.offsetHeight>0},empty:function(x){return !x.firstChild},parent:function(x){return !!x.firstChild},contains:function(x,y){return(x.textContent||x.innerText||"").indexOf(y)>=0},has:function(x,y){return !!(new w(y,x)).length},"first-child":function(x){while(x=x.previousSibling){if(x.nodeType===1){return false}}return true},"last-child":function(y,z,x){while(y=y.nextSibling){if(y.nodeType===1){return false}}return true},"only-child":function(y){var x=y;while(x=x.previousSibling){if(x.nodeType===1){return false}}x=y;while(x=x.nextSibling){if(x.nodeType===1){return false}}return true},"nth-child":function(y,z,x){var A=(x||a(y))-z.b;if(z.a==0){return A==0}else{return(A%z.a==0&&A/z.a>=0)}},header:function(x){return/h\d/i.test(x.nodeName)},not:function(y,z,x){return !s(z,y,x)}}};w.parseCSS=r})();